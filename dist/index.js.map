{"version":3,"file":"index.js","sources":["../src/send-data-to-db.ts","../src/launch-playwright.ts","../src/index.ts"],"sourcesContent":["const { PrismaClient } = require(\"@prisma/client\");\nconst prisma = new PrismaClient();\n\nconst sendDataToDB = async (\n  image: any,\n  page: { id: string; url: string },\n  browserType: string\n) => {\n  console.log(`========== Sending data to DB for ${browserType} ==========`);\n\n  const screenshot = await prisma.screenshot.create({\n    data: {\n      image,\n      page: {\n        connect: { id: page.id },\n      },\n    },\n  });\n\n  console.log(`========== /Sending data to DB for ${browserType} ==========`);\n\n  return {\n    screenshot,\n  };\n};\n\nexport default sendDataToDB;\n","import sendDataToDB from \"./send-data-to-db\";\n\nconst playwright = require(\"playwright\");\n\nconst launchPlaywright = async (\n  browserType: string,\n  args: string[],\n  page: { id: string; url: string }\n) => {\n  console.log(`========== Running Playwright for ${browserType} ==========`);\n\n  const browser = await playwright[browserType].launch({ args });\n  const browserPage = await browser.newPage();\n\n  await browserPage.goto(page.url);\n\n  const buffer = await browserPage.screenshot();\n  const image = buffer.toString(\"base64\");\n\n  await sendDataToDB(image, page, browserType);\n\n  await browser.close();\n\n  console.log(`========== /Running Playwright for ${browserType} ==========`);\n};\n\nexport default launchPlaywright;\n","import launchPlaywright from \"./launch-playwright\";\n\nconst { PrismaClient } = require(\"@prisma/client\");\nconst prisma = new PrismaClient();\n\nconst init = async (siteId: string) => {\n  console.log(\"========== Init ==========\");\n\n  try {\n    const site = await prisma.site.findOne({\n      where: {\n        id: siteId,\n      },\n      include: {\n        pages: true,\n      },\n    });\n\n    console.log(\"========== Site details ==========\");\n    console.log(site);\n    console.log(\"========== /Site details ==========\");\n\n    await site.pages.map(async (page: { id: string; url: string }) => {\n      await launchPlaywright(\"webkit\", [], page);\n      await launchPlaywright(\"firefox\", [], page);\n      await launchPlaywright(\"chromium\", [], page);\n\n      process.exit(0);\n    });\n  } catch (error) {\n    console.error(error);\n\n    process.exit(1);\n  }\n};\n\ninit(\"a37d5b4d-befb-410a-b421-bfaa5d176ba4\");\n"],"names":["require","PrismaClient","prisma","sendDataToDB","image","page","browserType","console","log","screenshot","create","data","connect","id","playwright","launchPlaywright","args","launch","browser","newPage","browserPage","url","buffer","toString","close","init","siteId","site","findOne","where","include","pages","map","process","exit","error"],"mappings":"eAAyBA,OAAO,CAAC,gBAAD;IAAxBC,wBAAAA;;AACR,IAAMC,MAAM,GAAG,IAAID,YAAJ,EAAf;;AAEA,IAAME,YAAY,YAAZA,YAAY,CAChBC,KADgB,EAEhBC,IAFgB,EAGhBC,WAHgB;AAAA;AAKhBC,IAAAA,OAAO,CAACC,GAAR,wCAAiDF,WAAjD;2BAEyBJ,MAAM,CAACO,UAAP,CAAkBC,MAAlB,CAAyB;AAChDC,MAAAA,IAAI,EAAE;AACJP,QAAAA,KAAK,EAALA,KADI;AAEJC,QAAAA,IAAI,EAAE;AACJO,UAAAA,OAAO,EAAE;AAAEC,YAAAA,EAAE,EAAER,IAAI,CAACQ;AAAX;AADL;AAFF;AAD0C,KAAzB,kBAAnBJ;AASNF,MAAAA,OAAO,CAACC,GAAR,yCAAkDF,WAAlD;AAEA,aAAO;AACLG,QAAAA,UAAU,EAAVA;AADK,OAAP;;AAGD,GArBiB;AAAA;AAAA;AAAA,CAAlB;;ACDA,IAAMK,UAAU,GAAGd,OAAO,CAAC,YAAD,CAA1B;;AAEA,IAAMe,gBAAgB,YAAhBA,gBAAgB,CACpBT,WADoB,EAEpBU,IAFoB,EAGpBX,IAHoB;AAAA;AAKpBE,IAAAA,OAAO,CAACC,GAAR,wCAAiDF,WAAjD;2BAEsBQ,UAAU,CAACR,WAAD,CAAV,CAAwBW,MAAxB,CAA+B;AAAED,MAAAA,IAAI,EAAJA;AAAF,KAA/B,kBAAhBE;6BACoBA,OAAO,CAACC,OAAR,mBAApBC;+BAEAA,WAAW,QAAX,CAAiBf,IAAI,CAACgB,GAAtB;iCAEeD,WAAW,CAACX,UAAZ,mBAAfa;AACN,gBAAMlB,KAAK,GAAGkB,MAAM,CAACC,QAAP,CAAgB,QAAhB,CAAd;mCAEMpB,YAAY,CAACC,KAAD,EAAQC,IAAR,EAAcC,WAAd;qCAEZY,OAAO,CAACM,KAAR;AAENjB,gBAAAA,OAAO,CAACC,GAAR,yCAAkDF,WAAlD;;;;;;;AACD,GApBqB;AAAA;AAAA;AAAA,CAAtB;;;;;;;;;;;;;;;;iBCFyBN,OAAO,CAAC,gBAAD;IAAxBC,4BAAAA;;AACR,IAAMC,QAAM,GAAG,IAAID,cAAJ,EAAf;;AAEA,IAAMwB,IAAI,YAAJA,IAAI,CAAUC,MAAV;AAAA;AACRnB,IAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;;oCAEI;AAAA,6BACiBN,QAAM,CAACyB,IAAP,CAAYC,OAAZ,CAAoB;AACrCC,QAAAA,KAAK,EAAE;AACLhB,UAAAA,EAAE,EAAEa;AADC,SAD8B;AAIrCI,QAAAA,OAAO,EAAE;AACPC,UAAAA,KAAK,EAAE;AADA;AAJ4B,OAApB,CADjB,iBACIJ,IADJ;AAUFpB,QAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYmB,IAAZ;AACApB,QAAAA,OAAO,CAACC,GAAR,CAAY,qCAAZ;AAZE,+BAcImB,IAAI,CAACI,KAAL,CAAWC,GAAX,WAAsB3B,IAAtB;AAAA;mCACEU,gBAAgB,CAAC,QAAD,EAAW,EAAX,EAAeV,IAAf;qCAChBU,gBAAgB,CAAC,SAAD,EAAY,EAAZ,EAAgBV,IAAhB;uCAChBU,gBAAgB,CAAC,UAAD,EAAa,EAAb,EAAiBV,IAAjB;AAEtB4B,kBAAAA,OAAO,CAACC,IAAR,CAAa,CAAb;;;;AACD,WANK;AAAA;AAAA;AAAA,UAdJ;AAAA;AAqBH,iBAAQC,OAAO;AACd5B,MAAAA,OAAO,CAAC4B,KAAR,CAAcA,KAAd;AAEAF,MAAAA,OAAO,CAACC,IAAR,CAAa,CAAb;AACD;;;AACF,GA7BS;AAAA;AAAA;AAAA,CAAV;;AA+BAT,IAAI,CAAC,sCAAD,CAAJ"}